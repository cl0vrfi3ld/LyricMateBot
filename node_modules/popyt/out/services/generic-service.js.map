{"version":3,"sources":["../src/services/generic-service.ts"],"names":[],"mappings":"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","file":"generic-service.js","sourcesContent":["import YouTube, { Video, Channel, Playlist, YTComment, VideoAbuseReportReason, Subscription, VideoCategory } from '..'\r\nimport { Cache, Parser } from '../util'\r\n\r\n/**\r\n * @ignore\r\n */\r\nexport class GenericService {\r\n  /* istanbul ignore next */\r\n  public static async getItem (youtube: YouTube, type: typeof Video | typeof Channel | typeof Playlist | typeof YTComment | typeof Subscription | typeof VideoCategory,\r\n    mine: boolean, id?: string): Promise<Video | Channel | Playlist | YTComment | Subscription | VideoCategory> {\r\n    if (!([ Video, Channel, Playlist, YTComment, Subscription, VideoCategory, VideoAbuseReportReason ].includes(type))) {\r\n      return Promise.reject('Type must be a video, channel, playlist, comment, subscription, or video category.')\r\n    }\r\n\r\n    if (!mine && (id === undefined || id === null)) {\r\n      return Promise.reject('Items must either specify an ID or the \\'mine\\' parameter.')\r\n    }\r\n\r\n    if (mine && (type === YTComment || type === Video)) {\r\n      return Promise.reject(`${type.endpoint} cannot be filtered by the 'mine' parameter.`)\r\n    }\r\n\r\n    const cached = Cache.get(`get://${type.endpoint}/${id ? id : 'mine'}`)\r\n\r\n    if (youtube._shouldCache && cached) {\r\n      return cached\r\n    }\r\n\r\n    const result = await youtube._request.api(type.endpoint, {\r\n      [id ? 'id' : 'mine']: id ? id : mine,\r\n      fields: encodeURIComponent(type.fields),\r\n      part: type === YTComment ? !type.part.includes('snippet') ? type.part + ',snippet' : type.part : type.part\r\n    }, youtube.token, youtube.accessToken)\r\n\r\n    if (result.items.length === 0) {\r\n      return Promise.reject('Item not found')\r\n    }\r\n\r\n    let endResult: Video | Playlist | Channel | YTComment | Subscription | VideoCategory\r\n\r\n    if (type === YTComment) {\r\n      endResult = new type(youtube, result.items[0], result.items[0].snippet.channelId ? 'channel' : 'video')\r\n    } else {\r\n      endResult = new (type as typeof Video | typeof Channel | typeof Playlist | typeof Subscription | typeof VideoCategory)(youtube, result.items[0])\r\n    }\r\n\r\n    youtube._cache(`get://${type.endpoint}/${id ? id : 'mine'}`, endResult)\r\n\r\n    return endResult\r\n  }\r\n\r\n  /* istanbul ignore next */\r\n  public static async getPaginatedItems (youtube: YouTube, endpoint: 'playlistItems' | 'playlists' | 'playlists:channel' | 'commentThreads' |\r\n    'commentThreads:video' | 'commentThreads:channel' | 'comments' | 'subscriptions' | 'videoCategories' | 'videoAbuseReportReasons',\r\n    mine: boolean, id?: string, maxResults: number = -1): Promise<Video[] | YTComment[] | Playlist[] | Subscription[] | VideoCategory[] | VideoAbuseReportReason[]> {\r\n    if (!mine && (id === undefined || id === null) && endpoint !== 'videoAbuseReportReasons') {\r\n      return Promise.reject(`${endpoint} must either specify an ID or the 'mine' parameter.`)\r\n    }\r\n\r\n    if (mine && (endpoint.startsWith('comment') || [ 'playlistItems', 'videoCategories' ].includes(endpoint))) {\r\n      return Promise.reject(`${endpoint} cannot be filtered by the 'mine' parameter.`)\r\n    }\r\n\r\n    const cached = Cache.get(`get://${endpoint}/${id ? id : 'mine'}/${maxResults}`)\r\n\r\n    if (youtube._shouldCache && cached) {\r\n      return cached\r\n    }\r\n\r\n    let items = []\r\n\r\n    const full = maxResults <= 0\r\n    const options: {\r\n      part: string,\r\n      maxResults?: number,\r\n      videoId?: string,\r\n      parentId?: string,\r\n      textFormat?: string,\r\n      playlistId?: string,\r\n      channelId?: string,\r\n      regionCode?: string\r\n      pageToken?: string,\r\n      mine?: boolean\r\n    } = {\r\n      part: 'snippet'\r\n    }\r\n\r\n    let max: number\r\n    let clazz: typeof Video | typeof YTComment | typeof Playlist | typeof Subscription | typeof VideoCategory | typeof VideoAbuseReportReason\r\n    let commentType: 'video' | 'channel'\r\n\r\n    if (endpoint === 'playlistItems') {\r\n      max = 50\r\n      clazz = Video\r\n      options.playlistId = id\r\n    } else if (endpoint.startsWith('commentThreads')) {\r\n      max = 100\r\n      clazz = YTComment\r\n\r\n      const [, type ] = endpoint.split(':') as ('video' | 'channel')[]\r\n\r\n      commentType = type ? type : 'video'\r\n      endpoint = 'commentThreads'\r\n      options[`${type}Id`] = id\r\n      options.textFormat = 'plainText'\r\n    } else if (endpoint === 'comments') {\r\n      max = 100\r\n      clazz = YTComment\r\n      options.parentId = id\r\n    } else if (endpoint === 'playlists:channel') {\r\n      max = 50\r\n      clazz = Playlist\r\n      endpoint = 'playlists'\r\n      if (mine) options.mine = mine; else options.channelId = id\r\n    } else if (endpoint === 'subscriptions') {\r\n      max = 50\r\n      clazz = Subscription\r\n      if (mine) options.mine = mine; else options.channelId = id\r\n    } else if (endpoint === 'videoCategories') {\r\n      clazz = VideoCategory\r\n      options.regionCode = id\r\n    } else if (endpoint === 'videoAbuseReportReasons') {\r\n      clazz = VideoAbuseReportReason\r\n    } else {\r\n      return Promise.reject('Unknown item type ' + endpoint)\r\n    }\r\n\r\n    if (max && maxResults > max) {\r\n      return Promise.reject(`Max results must be ${max} or below for ${endpoint}`)\r\n    }\r\n\r\n    if (max) {\r\n      options.maxResults = full ? max : maxResults\r\n    }\r\n\r\n    let results\r\n    let pages = null\r\n    let shouldReturn = !full\r\n\r\n    for (let i = 1; i < pages ? pages : 3; i++) {\r\n      results = await youtube._request.api(endpoint, options, youtube.token, youtube.accessToken)\r\n\r\n      if (results.items.length === 0) {\r\n        return Promise.reject(`${endpoint} not found`)\r\n      }\r\n\r\n      if (!pages) {\r\n        pages = results.pageInfo ? results.pageInfo.totalResults / results.pageInfo.resultsPerPage : 0\r\n\r\n        if (pages <= 1) {\r\n          shouldReturn = true\r\n        }\r\n\r\n        pages = Math.floor(pages)\r\n      }\r\n\r\n      results.items.forEach(item => {\r\n        let comment: YTComment\r\n\r\n        if (item.snippet.topLevelComment) {\r\n          comment = new YTComment(youtube, item.snippet.topLevelComment, commentType)\r\n          items.push(comment)\r\n        } else {\r\n          items.push(new clazz(youtube, item, commentType))\r\n        }\r\n\r\n        if (item.replies) {\r\n          item.replies.comments.forEach(reply => {\r\n            const created = new YTComment(youtube, reply, commentType)\r\n            comment.replies.push(created)\r\n          })\r\n        }\r\n      })\r\n\r\n      if (results.nextPageToken && !shouldReturn) {\r\n        options.pageToken = results.nextPageToken\r\n      } else {\r\n        return items\r\n      }\r\n    }\r\n\r\n    youtube._cache(`get://${endpoint}/${id ? id : 'mine'}/${maxResults}`, items)\r\n\r\n    return items\r\n  }\r\n\r\n  /* istanbul ignore next */\r\n  public static async getId (youtube: YouTube, input: string, type: typeof Video | typeof Channel | typeof Playlist): Promise<string> {\r\n    let id: string = null\r\n\r\n    const cached = Cache.get(`get_id://${type.endpoint}/${input}`)\r\n\r\n    if (cached) {\r\n      return cached\r\n    }\r\n\r\n    const cachedEntity: Video | Channel | Playlist | YTComment = Cache.get(`get://${type.endpoint}/${input}`)\r\n\r\n    if (cachedEntity && cachedEntity.id) {\r\n      return cachedEntity.id\r\n    }\r\n\r\n    if (input.includes('youtube.com') || input.includes('youtu.be')) {\r\n      const idFromUrl = Parser.parseUrl(input)[type.name.toLowerCase()]\r\n\r\n      // Custom channel URLs don't work that well\r\n      if (type === Channel && idFromUrl && !idFromUrl.startsWith('UC')) {\r\n        id = await youtube._request.api('search', {\r\n          q: encodeURIComponent(idFromUrl),\r\n          type: 'channel',\r\n          part: 'id'\r\n        }, youtube.token, youtube.accessToken).then(r => r.items[0] ? r.items[0].id.channelId : undefined)\r\n      }\r\n\r\n      id = idFromUrl\r\n    }\r\n\r\n    if (id !== null && id !== undefined && id !== '') {\r\n      return id\r\n    }\r\n\r\n    if (type === Channel && (!input.startsWith('UC') || input.includes(' '))) {\r\n      id = await youtube._request.api('search', {\r\n        q: encodeURIComponent(input),\r\n        type: 'channel',\r\n        part: 'id', maxResults: 1\r\n      }, youtube.token, youtube.accessToken).then(r => r.items.length > 0 ? r.items[0].id.channelId : undefined)\r\n    } else if (type === Playlist && input.includes(' ')) {\r\n      id = await youtube._request.api('search', {\r\n        q: encodeURIComponent(input),\r\n        type: 'playlist',\r\n        part: 'id',\r\n        maxResults: 1\r\n      }, youtube.token, youtube.accessToken).then(r => r.items.length > 0 ? r.items[0].id.playlistId : undefined)\r\n    } else if (type === Video && (input.length < 11 || input.includes(' '))) {\r\n      id = await youtube._request.api('search', {\r\n        q: encodeURIComponent(input),\r\n        type: 'video',\r\n        part: 'id',\r\n        maxResults: 1\r\n      }, youtube.token, youtube.accessToken).then(r => r.items.length > 0 ? r.items[0].id.videoId : undefined)\r\n    }\r\n\r\n    if (id === null || id === undefined || id === '') {\r\n      id = input\r\n    }\r\n\r\n    youtube._cache(`get_id://${type.endpoint}/${input}`, id)\r\n\r\n    return id\r\n  }\r\n}\r\n"],"sourceRoot":"../../src"}